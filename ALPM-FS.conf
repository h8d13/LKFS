# ALPM-FS Configuration File
# Bootable Alpine Linux System Configuration

# ============================================
# Filesystem Configuration
# ============================================

# Root filesystem type (ext4, xfs, btrfs, f2fs)
ROOT_FS_TYPE="ext4"

# Root filesystem mount options
ROOT_FS_OPTS="rw,relatime"

# EFI partition size in MiB
EFI_SIZE=512

# ============================================
# Alpine Repository
# ============================================

# Alpine version (e.g., v3.22, v3.21, edge) (Minor version automatically takes latest)
# WARNING: Needs "edge" to run "linux-stable" (expect some bugs too)
# If this is changed between runs any progress in alpinestein chroot would be lost
ALPINE_VERSION="v3.22"

# Enable testing repository (contains experimental/newer packages)
# NOTE: Testing repo uses edge branch (${ALPINE_MIRROR}/edge/testing)
# Works with any version, commonly used for packages like vscodium and refind
ENABLE_TESTING="yes"

# Alpine mirror
ALPINE_MIRROR="https://dl-cdn.alpinelinux.org/alpine"

# ============================================
# zram Configuration
# ============================================

# zram size in MiB
ZRAM_SIZE=8192

# zram compression algorithm (lzo, lz4, zstd)
ZRAM_ALGO="zstd"

# ============================================
# Boot Configuration
# ============================================

# Bootloader choice (grub or refind)
# NOTE: rEFInd requires ENABLE_TESTING="yes" (available in edge/testing repository)
BOOTLOADER="grub"

# GRUB timeout in seconds
GRUB_TIMEOUT=1

# GRUB menu entry name
GRUB_MENUENTRY="ALPM-FS"

# rEFInd timeout in seconds
REFIND_TIMEOUT=20

# rEFInd resolution (e.g., 1920 1080)
REFIND_RESOLUTION="1920 1080"

# rEFInd menu entry name
REFIND_MENUENTRY="Alpine Linux"

# Extra kernel command line parameters (console, quiet, etc)
# Note: rootfstype and modules are auto-generated based on ROOT_FS_TYPE
# The rest is up to you to figure out for your hardware... This example setting fixes my Iris laptop's GPU
KERNEL_CMDLINE_EXTRA="console=tty0 i915.enable_guc=0"

# ============================================
# System Packages
# ============================================
# Core system packages (space-separated)

# x86_64 kernel options:
# linux-lts (Long Term Support, most hardware)

# linux-stable (latest stable kernel) # NEEDS ALPINE_VERSION="edge" enabled
# and on alpine this one means trouble
# linux-virt (minimal VM kernel, omits a lot of drivers)
# linux-openpax (OpenPAX security memory patches)

KERNEL_FLAVOR="linux-lts"

CORE_PACKAGES="$KERNEL_FLAVOR linux-firmware-none acpi mkinitfs"

CORE_PACKAGES2="linux-firmware-other" ## can be removed for VM usage

# linux-firmware for all
# ============================================
# HARDWARE
# ============================================

HW_GROUP_INTEL="intel-ucode linux-firmware-intel intel-gmmlib intel-media-driver libva-intel-driver mesa-vulkan-intel"

# ============================================
# GRAPHICS
# ============================================

GP_GROUP_MESA="mesa mesa-gl mesa-va-gallium mesa-dri-gallium"

# ============================================
# PKGS
# ============================================

# Boot packages (will be overridden based on BOOTLOADER choice)
BOOT_PACKAGES="grub grub-efi efibootmgr"

# System utilities
SYSTEM_PACKAGES="openrc openrc-init util-linux coreutils e2fsprogs dosfstools"

# Additional packages
EXTRA_PACKAGES="acpid busybox-openrc busybox-extras busybox-mdev-openrc alpine-conf kbd-bkeymaps kbd zram-init iptables pciutils busybox-extras ufw ip6tables util-linux wget curl tar zstd hwinfo lshw usbutils micro bash"

WIFI_NEEDED="yes"
WIFI_PACKAGES="networkmanager networkmanager-wifi networkmanager-cli wpa_supplicant dbus dbus-openrc eudev"

SERVICES_DEFAULT_WIFI="dbus networkmanager"

# ============================================
# Boot Services
# ============================================

# Services to add to sysinit runlevel (space-separated)
SERVICES_SYSINIT="devfs dmesg mdev"

# Services to add to boot runlevel
SERVICES_BOOT="hwclock modules sysctl hostname bootmisc syslog localmount zram-init"

# Services to add to shutdown runlevel
SERVICES_SHUTDOWN="mount-ro killprocs savecache"

# Services to add to default runlevel
SERVICES_DEFAULT="acpid"

# ============================================
# User Configuration
# ============================================

# Hostname
HOSTNAME="alpmfs"

# Default root password
ROOT_PASSWORD="alpine"